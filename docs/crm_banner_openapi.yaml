openapi: 3.0.3
info:
  title: CRM Banner API
  description: CRM Banner 管理接口
  version: 1.0.0
servers:
  - url: /
tags:
  - name: banner
    description: Banner 管理

components:
  schemas:
    Banner:
      type: object
      properties:
        id:
          type: integer
          format: int64
          description: 主键ID
        sorting:
          type: integer
          description: 排序
        image:
          type: string
          description: 图片URL
        title:
          type: string
          description: 标题
        jump_type:
          type: string
          description: 跳转类型
        jump_url:
          type: string
          description: 跳转URL
        miniapp_page:
          type: string
          description: 小程序页面路径
        miniapp_app_id:
          type: string
          description: 小程序AppID
        extra_data:
          type: object
          description: 扩展数据
        visible_for:
          type: object
          description: 可见范围
        status:
          type: integer
          description: 状态
        created_at:
          type: string
          format: date-time
          description: 创建时间
        updated_at:
          type: string
          format: date-time
          description: 更新时间
        deleted_at:
          type: string
          format: date-time
          description: 删除时间

    BannerInput:
      type: object
      required:
        - image
        - title
        - jump_type
      properties:
        sorting:
          type: integer
          description: 排序
        image:
          type: string
          description: 图片URL
        title:
          type: string
          description: 标题
        jump_type:
          type: string
          description: 跳转类型
        jump_url:
          type: string
          description: 跳转URL
        miniapp_page:
          type: string
          description: 小程序页面路径
        miniapp_app_id:
          type: string
          description: 小程序AppID
        extra_data:
          type: object
          description: 扩展数据
        visible_for:
          type: object
          description: 可见范围
        status:
          type: integer
          description: 状态

    BannerUpdateRequest:
      type: object
      required:
        - id
      properties:
        id:
          type: integer
          format: int64
          description: 主键ID
        sorting:
          type: integer
          description: 排序
        image:
          type: string
          description: 图片URL
        title:
          type: string
          description: 标题
        jump_type:
          type: string
          description: 跳转类型
        jump_url:
          type: string
          description: 跳转URL
        miniapp_page:
          type: string
          description: 小程序页面路径
        miniapp_app_id:
          type: string
          description: 小程序AppID
        extra_data:
          type: object
          description: 扩展数据
        visible_for:
          type: object
          description: 可见范围
        status:
          type: integer
          description: 状态

    BannerDeleteRequest:
      type: object
      required:
        - id
      properties:
        id:
          type: integer
          format: int64
          description: 主键ID

    BannerBatchDeleteRequest:
      type: object
      required:
        - ids
      properties:
        ids:
          type: array
          items:
            type: integer
            format: int64
          description: 主键ID列表

    ApiResponseList:
      type: object
      properties:
        code:
          type: integer
          description: 状态码
        msg:
          type: string
          description: 提示信息
        data:
          type: object
          properties:
            total:
              type: integer
              description: 总记录数
            items:
              type: array
              items:
                $ref: '#/components/schemas/Banner'

    ApiResponseDetail:
      type: object
      properties:
        code:
          type: integer
          description: 状态码
        msg:
          type: string
          description: 提示信息
        data:
          $ref: '#/components/schemas/Banner'

    ApiResponseAction:
      type: object
      properties:
        code:
          type: integer
          description: 状态码
        msg:
          type: string
          description: 提示信息
        data:
          type: object
          nullable: true

paths:
  /banner:
    get:
      summary: 获取 Banner 列表
      tags:
        - banner
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            default: 1
          description: 页码
        - name: page_size
          in: query
          schema:
            type: integer
            default: 20
            maximum: 100
          description: 每页数量
        - name: sort_by
          in: query
          schema:
            type: string
          description: 排序字段
        - name: sort_order
          in: query
          schema:
            type: string
            enum: [asc, desc]
          description: 排序方向
        - name: sorting
          in: query
          schema:
            type: integer
          description: 排序
        - name: title
          in: query
          schema:
            type: string
          description: 标题
        - name: jump_type
          in: query
          schema:
            type: string
          description: 跳转类型
        - name: status
          in: query
          schema:
            type: integer
          description: 状态
        - name: created_at_min
          in: query
          schema:
            type: string
            format: date-time
          description: 创建时间-开始
        - name: created_at_max
          in: query
          schema:
            type: string
            format: date-time
          description: 创建时间-结束
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseList'
              example:
                code: 0
                msg: success
                data:
                  total: 2
                  items:
                    - id: 1
                      sorting: 1
                      image: "https://example.com/banner1.jpg"
                      title: "活动横幅"
                      jump_type: "url"
                      jump_url: "https://example.com/activity"
                      miniapp_page: ""
                      miniapp_app_id: ""
                      extra_data: null
                      visible_for: {}
                      status: 1
                      created_at: "2024-01-01T00:00:00Z"
                      updated_at: "2024-01-01T00:00:00Z"
                      deleted_at: "1970-01-01T00:00:00Z"
                    - id: 2
                      sorting: 2
                      image: "https://example.com/banner2.jpg"
                      title: "新品推荐"
                      jump_type: "miniapp"
                      jump_url: ""
                      miniapp_page: "pages/product/detail"
                      miniapp_app_id: "wx1234567890"
                      extra_data: null
                      visible_for: {}
                      status: 1
                      created_at: "2024-01-02T00:00:00Z"
                      updated_at: "2024-01-02T00:00:00Z"
                      deleted_at: "1970-01-01T00:00:00Z"

  /banner/detail:
    get:
      summary: 获取 Banner 详情
      tags:
        - banner
      parameters:
        - name: id
          in: query
          required: true
          schema:
            type: integer
            format: int64
          description: 主键ID
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseDetail'
              example:
                code: 0
                msg: success
                data:
                  id: 1
                  sorting: 1
                  image: "https://example.com/banner1.jpg"
                  title: "活动横幅"
                  jump_type: "url"
                  jump_url: "https://example.com/activity"
                  miniapp_page: ""
                  miniapp_app_id: ""
                  extra_data: null
                  visible_for: {}
                  status: 1
                  created_at: "2024-01-01T00:00:00Z"
                  updated_at: "2024-01-01T00:00:00Z"
                  deleted_at: "1970-01-01T00:00:00Z"

  /banner/create:
    post:
      summary: 创建 Banner
      tags:
        - banner
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BannerInput'
            example:
              sorting: 1
              image: "https://example.com/banner1.jpg"
              title: "活动横幅"
              jump_type: "url"
              jump_url: "https://example.com/activity"
              miniapp_page: ""
              miniapp_app_id: ""
              extra_data: null
              visible_for: {}
              status: 1
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseAction'
              example:
                code: 0
                msg: success
                data: null

  /banner/update:
    post:
      summary: 更新 Banner
      tags:
        - banner
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BannerUpdateRequest'
            example:
              id: 1
              sorting: 1
              image: "https://example.com/banner1.jpg"
              title: "活动横幅"
              jump_type: "url"
              jump_url: "https://example.com/activity"
              miniapp_page: ""
              miniapp_app_id: ""
              extra_data: null
              visible_for: {}
              status: 1
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseAction'
              example:
                code: 0
                msg: success
                data: null

  /banner/delete:
    post:
      summary: 删除 Banner
      tags:
        - banner
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BannerDeleteRequest'
            example:
              id: 1
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseAction'
              example:
                code: 0
                msg: success
                data: null

  /banner/batch-delete:
    post:
      summary: 批量删除 Banner
      tags:
        - banner
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BannerBatchDeleteRequest'
            example:
              ids: [1, 2, 3]
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseAction'
              example:
                code: 0
                msg: success
                data: null
